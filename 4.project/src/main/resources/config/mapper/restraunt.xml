<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.org.jejutour.repository.dao.RestrauntMapper">
	
	<resultMap id="restrauntBoardMap" type="restrauntBoard">
		<result column="member_no" property="memberNo"/>
		<result column="board_no" property="boardNo"/>
		<result column="name" property="name" />
		<result column="intro" property="intro" />
		<result column="like_cnt" property="likeCnt" />
		<result column="view_cnt" property="viewCnt" />
		<result column="food_category" property="foodCategory" />
		<result column="business_hours" property="businessHours" />
		<result column="amendity" property="amendity" />
		<result column="like_status" property="likeStatus" />
		<result column="location" property="location" />
	</resultMap>
	
	<resultMap id="restrauntFileMap" type="restrauntFile">
		<result column="member_no" property="memberNo"/>
		<result column="board_no" property="boardNo"/>
		<result column="name" property="name" />
		<result column="path" property="path" />
	</resultMap>
	<!-- 게시글 선택 -->
	<select id="selectRestrauntBoardByNo" parameterType="int" resultMap="restrauntBoardMap">
	  select *
		from tb_restraunt_board
	   where board_no= #{boardNo}
	</select>
	<insert id="insertFile" parameterType="restrauntFile">
		insert into tb_restraunt_file (
			board_no, file_no, name, path
		) values (
		   s_restraunt_board_no.nextval, s_restraunt_file_no.nextval, #{name}, #{path}		
		)
	</insert> 	 
	<insert id="insertFileNoneSe" parameterType="restrauntFile">
		insert into tb_restraunt_file (
			board_no, file_no, name, path
		) values (
		   #{boardNo}, s_restraunt_file_no.nextval, #{name}, #{path}		
		)
	</insert> 	 
	<select id="selectFileByNo" parameterType="String" resultType="int">
		select board_no
		  from tb_restraunt_file
		 where name=#{name}
	</select>
	
	<!-- 사진경로 불러오기 -->
<!-- 	<select id="selectRestrauntFileByNo" parameterType="int" resultMap="restrauntFileMap">
	  select *
		from tb_restraunt_file
	   where board_no= #{boardNo}
	</select> -->
	
	<select id="selectRestrauntFileByNo" parameterType="int" resultType="String">
	  select path
		from tb_restraunt_file
	   where board_no= #{boardNo}
	</select>
	
	<!-- 지역값1 불러오기 -->
	<select id="selectRestrauntLoacationByNo" parameterType="int" resultType="String">
		select value_name
		  from tb_code
		 where groups=#{groups}
	</select>
	
	<!-- 글추가 -->
	 <insert id="insertBoard" parameterType="restrauntBoard">
		<selectKey keyProperty="boardNo" resultType="int" order="BEFORE">
    		select s_restraunt_board_no.nextval from dual
    	</selectKey>
		insert into tb_restraunt_board(
			member_no, board_no, name, intro, food_category, business_hours, amendity, location
		) values (																																
			#{memberNo}, s_restraunt_board_no.nextval, 
			#{name}, #{intro}, 
			#{foodCategory}, #{businessHours},
			#{amendity},#{location}
		) 
	</insert>
	
	
	

</mapper>
























